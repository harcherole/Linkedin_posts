<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Polars vs Pandas</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="pandas-vs-polars-—-sheet-pratique-avec-données-synthétiques">Pandas vs Polars — Sheet pratique (avec données synthétiques)</h1>
<p><em>Georf MIGUIAMA BAMBA</em></p>
<h2 id="définitions">1) Définitions</h2>
<p><strong>Pandas</strong><br>
Bibliothèque Python pour la manipulation et l’analyse de données, avec des structures <strong>DataFrame</strong> et <strong>Series</strong> adaptées au nettoyage, à la transformation et à l’exploration des données.</p>
<p><strong>Polars</strong><br>
Bibliothèque moderne (Python/Rust) pour le traitement de données, fondée sur <strong>Apache Arrow</strong>, <strong>multi‑threadée</strong>, et proposant un mode <strong>lazy</strong> (<code>scan_*</code> → <code>collect</code>) qui applique des optimisations automatiques (predicate/projection pushdown).</p>
<p><strong>Références</strong> : <a href="https://docs.pola.rs/user-guide/concepts/lazy-api/">Polars — Lazy API</a>, <a href="https://docs.pola.rs/user-guide/migration/pandas/">Polars — Coming from Pandas</a>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">Pandas DataFrame (docs)</a>, <a href="https://www.rhosignal.com/posts/polars-pandas-cheatsheet/">Cheatsheet Pandas→Polars (Rho Signal)</a></p>
<hr>
<h2 id="différences-clés-venir-de-pandas">2) Différences clés (venir de Pandas)</h2>
<ul>
<li><strong>Index</strong> : Pandas utilise un index de ligne; <strong>Polars n’utilise pas d’index</strong> (positions de ligne), ce qui rend les opérations plus explicites.</li>
<li><strong>Mémoire</strong> : Pandas s’appuie surtout sur <strong>NumPy</strong>; Polars suit le format colonnaire <strong>Apache Arrow</strong>.</li>
<li><strong>Parallélisme &amp; Lazy</strong> : Polars utilise le <strong>multi‑thread</strong> et un <strong>plan d’exécution lazy</strong> (<code>scan_*</code>, <code>collect</code>, <code>.explain()</code>).</li>
<li><strong>Performance</strong> : Polars est généralement plus rapide et plus économe en mémoire sur gros volumes.</li>
</ul>
<p>Réfs : <a href="https://docs.pola.rs/user-guide/migration/pandas/">Coming from Pandas</a>, <a href="https://docs.pola.rs/user-guide/concepts/lazy-api/">Lazy API</a></p>
<hr>
<h2 id="génération-du-dataset-paramètres-fournis">3) Génération du dataset (paramètres fournis)</h2>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timedelta

n_rows <span class="token operator">=</span> <span class="token number">1000</span>
categories <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Electronics"</span><span class="token punctuation">,</span> <span class="token string">"Furniture"</span><span class="token punctuation">,</span> <span class="token string">"Stationery"</span><span class="token punctuation">,</span> <span class="token string">"Kitchen"</span><span class="token punctuation">,</span> <span class="token string">"Toys"</span><span class="token punctuation">]</span>
products <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">"Laptop"</span><span class="token punctuation">,</span> <span class="token string">"Mouse"</span><span class="token punctuation">,</span> <span class="token string">"Chair"</span><span class="token punctuation">,</span> <span class="token string">"Desk"</span><span class="token punctuation">,</span> <span class="token string">"Pen"</span><span class="token punctuation">,</span> <span class="token string">"Notebook"</span><span class="token punctuation">,</span>
    <span class="token string">"Monitor"</span><span class="token punctuation">,</span> <span class="token string">"Lamp"</span><span class="token punctuation">,</span> <span class="token string">"Keyboard"</span><span class="token punctuation">,</span> <span class="token string">"Cable"</span>
<span class="token punctuation">]</span>

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>
data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">"id"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> n_rows <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"date"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">(</span>datetime<span class="token punctuation">(</span><span class="token number">2025</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n_rows<span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"category"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>categories<span class="token punctuation">,</span> n_rows<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"product"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>products<span class="token punctuation">,</span> n_rows<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"price"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> n_rows<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"quantity"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> n_rows<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"active"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">,</span> n_rows<span class="token punctuation">,</span> p<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">"score"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> n_rows<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
<hr>
<h2 id="lecture--lazy">4) Lecture &amp; Lazy</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

df_pd <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
df_pd<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">"data.csv"</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
df_pd_csv <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"data.csv"</span><span class="token punctuation">)</span>
<span class="token comment"># Parquet (requiert pyarrow/fastparquet)</span>
df_pd<span class="token punctuation">.</span>to_parquet<span class="token punctuation">(</span><span class="token string">"data.parquet"</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">import</span> polars <span class="token keyword">as</span> pl

df_pl <span class="token operator">=</span> pl<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
df_pl<span class="token punctuation">.</span>write_parquet<span class="token punctuation">(</span><span class="token string">"data.parquet"</span><span class="token punctuation">)</span>
df_pl_csv <span class="token operator">=</span> pl<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"data.csv"</span><span class="token punctuation">)</span>
df_pl_parquet <span class="token operator">=</span> pl<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span><span class="token string">"data.parquet"</span><span class="token punctuation">)</span>

<span class="token comment"># Lazy + optimisations de lecture</span>
q <span class="token operator">=</span> <span class="token punctuation">(</span>pl<span class="token punctuation">.</span>scan_csv<span class="token punctuation">(</span><span class="token string">"data.csv"</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">,</span><span class="token string">"price"</span><span class="token punctuation">,</span><span class="token string">"category"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df_lazy <span class="token operator">=</span> q<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="inspection">5) Inspection</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">df_pd_csv<span class="token punctuation">.</span>shape
df_pd_csv<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
df_pd_csv<span class="token punctuation">.</span>dtypes
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">df_pl_csv<span class="token punctuation">.</span>shape
df_pl_csv<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
df_pl_csv<span class="token punctuation">.</span>dtypes
</code></pre>
<hr>
<h2 id="sélection--cast">6) Sélection &amp; cast</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">df_pd2 <span class="token operator">=</span> df_pd_csv<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>price_float<span class="token operator">=</span><span class="token keyword">lambda</span> d<span class="token punctuation">:</span> d<span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">"float64"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df_pd2<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">,</span><span class="token string">"price_float"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">df_pl2 <span class="token operator">=</span> df_pl_csv<span class="token punctuation">.</span>with_columns<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cast<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>Float64<span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">"price_float"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df_pl2<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">,</span><span class="token string">"price_float"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="filtres">7) Filtres</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">f_pd <span class="token operator">=</span> df_pd2<span class="token punctuation">[</span><span class="token punctuation">(</span>df_pd2<span class="token punctuation">[</span><span class="token string">"category"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"Electronics"</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df_pd2<span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
f_pd<span class="token punctuation">.</span>shape
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">f_pl <span class="token operator">=</span> df_pl2<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"category"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">"Electronics"</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f_pl<span class="token punctuation">.</span>shape
</code></pre>
<hr>
<h2 id="colonnes-dérivées">8) Colonnes dérivées</h2>
<blockquote>
<p>En Polars, évite de référencer une nouvelle colonne dans la <strong>même</strong> <code>with_columns</code>. Procède en <strong>deux passes</strong>.</p>
</blockquote>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">df_pd5 <span class="token operator">=</span> df_pd_csv<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_pd5<span class="token punctuation">[</span><span class="token string">"total"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_pd5<span class="token punctuation">[</span><span class="token string">"price"</span><span class="token punctuation">]</span> <span class="token operator">*</span> df_pd5<span class="token punctuation">[</span><span class="token string">"quantity"</span><span class="token punctuation">]</span>
df_pd5<span class="token punctuation">[</span><span class="token string">"high_value"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>df_pd5<span class="token punctuation">[</span><span class="token string">"total"</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">10000</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">df_pl5 <span class="token operator">=</span> df_pl_csv<span class="token punctuation">.</span>with_columns<span class="token punctuation">(</span><span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span><span class="token operator">*</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"quantity"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">"total"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df_pl5 <span class="token operator">=</span> df_pl5<span class="token punctuation">.</span>with_columns<span class="token punctuation">(</span><span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"total"</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">"high_value"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="groupby--agrégations">9) GroupBy &amp; agrégations</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">g_pd <span class="token operator">=</span> <span class="token punctuation">(</span>df_pd5<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">"category"</span><span class="token punctuation">,</span> as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"quantity"</span><span class="token punctuation">:</span><span class="token string">"sum"</span><span class="token punctuation">,</span><span class="token string">"price"</span><span class="token punctuation">:</span><span class="token string">"mean"</span><span class="token punctuation">,</span><span class="token string">"score"</span><span class="token punctuation">:</span><span class="token string">"max"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">g_pl <span class="token operator">=</span> <span class="token punctuation">(</span>df_pl5<span class="token punctuation">.</span>group_by<span class="token punctuation">(</span><span class="token string">"category"</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"quantity"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">"quantity_sum"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"price"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">"price_mean"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"score"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">"score_max"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
              <span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token string">"category"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="joins">10) Joins</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">suppliers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Contoso"</span><span class="token punctuation">,</span><span class="token string">"Northwind"</span><span class="token punctuation">,</span><span class="token string">"Fabrikam"</span><span class="token punctuation">,</span><span class="token string">"AdventureWorks"</span><span class="token punctuation">]</span>
prod_unique <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">(</span>df_pd5<span class="token punctuation">[</span><span class="token string">"product"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
sup_pd <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"product"</span><span class="token punctuation">:</span> prod_unique<span class="token punctuation">,</span>
                       <span class="token string">"supplier"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>suppliers<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> prod_unique<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

j_pd <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_pd5<span class="token punctuation">,</span> sup_pd<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">"product"</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">sup_pl <span class="token operator">=</span> pl<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"product"</span><span class="token punctuation">:</span> prod_unique<span class="token punctuation">,</span>
                       <span class="token string">"supplier"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>suppliers<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> prod_unique<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

j_pl <span class="token operator">=</span> df_pl5<span class="token punctuation">.</span>join<span class="token punctuation">(</span>sup_pl<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">"product"</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="tri">11) Tri</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">s_pd <span class="token operator">=</span> df_pd5<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"category"</span><span class="token punctuation">,</span><span class="token string">"price"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">s_pl <span class="token operator">=</span> df_pl5<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"category"</span><span class="token punctuation">,</span><span class="token string">"price"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> descending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="reshape-meltpivot">12) Reshape (melt/pivot)</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">m_pd <span class="token operator">=</span> df_pd5<span class="token punctuation">.</span>melt<span class="token punctuation">(</span>id_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">,</span><span class="token string">"category"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> value_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"quantity"</span><span class="token punctuation">,</span><span class="token string">"score"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                   var_name<span class="token operator">=</span><span class="token string">"metric"</span><span class="token punctuation">,</span> value_name<span class="token operator">=</span><span class="token string">"value"</span><span class="token punctuation">)</span>

p_pd <span class="token operator">=</span> <span class="token punctuation">(</span>df_pd5<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token string">"category"</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">"product"</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token string">"quantity"</span><span class="token punctuation">,</span>
                           aggfunc<span class="token operator">=</span><span class="token string">"sum"</span><span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">m_pl <span class="token operator">=</span> <span class="token punctuation">(</span>df_pl5<span class="token punctuation">.</span>melt<span class="token punctuation">(</span>id_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">,</span><span class="token string">"category"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> value_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"quantity"</span><span class="token punctuation">,</span><span class="token string">"score"</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
              <span class="token punctuation">.</span>rename<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"variable"</span><span class="token punctuation">:</span><span class="token string">"metric"</span><span class="token punctuation">,</span><span class="token string">"value"</span><span class="token punctuation">:</span><span class="token string">"value"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

p_pl <span class="token operator">=</span> df_pl5<span class="token punctuation">.</span>pivot<span class="token punctuation">(</span>values<span class="token operator">=</span><span class="token string">"quantity"</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token string">"category"</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token string">"product"</span><span class="token punctuation">,</span> aggregate_fn<span class="token operator">=</span><span class="token string">"sum"</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="données-manquantes">13) Données manquantes</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">idx_nan <span class="token operator">=</span> df_pd5<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>frac<span class="token operator">=</span><span class="token number">0.02</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">.</span>index
df_pd_nan <span class="token operator">=</span> df_pd5<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_pd_nan<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>idx_nan<span class="token punctuation">,</span> <span class="token string">"product"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>

df_pd_drop <span class="token operator">=</span> df_pd_nan<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"product"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># supprime lignes avec product manquant</span>
df_pd_fill <span class="token operator">=</span> df_pd_nan<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"product"</span><span class="token punctuation">:</span><span class="token string">"Unknown"</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">df_pl_nan <span class="token operator">=</span> df_pl5<span class="token punctuation">.</span>with_columns<span class="token punctuation">(</span>
    pl<span class="token punctuation">.</span>when<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">50</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>then<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>lit<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>otherwise<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"product"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">"product"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>

df_pl_drop <span class="token operator">=</span> df_pl_nan<span class="token punctuation">.</span>drop_nulls<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"product"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># supprime lignes avec null dans product</span>
df_pl_fill <span class="token operator">=</span> df_pl_nan<span class="token punctuation">.</span>with_columns<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"product"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fill_null<span class="token punctuation">(</span><span class="token string">"Unknown"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="datetime--strings">14) Datetime &amp; strings</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python">df_pd_dt <span class="token operator">=</span> df_pd5<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_pd_dt<span class="token punctuation">[</span><span class="token string">"date"</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df_pd_dt<span class="token punctuation">[</span><span class="token string">"date"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># parsing</span>

df_pd_dt<span class="token punctuation">[</span><span class="token string">"month"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_pd_dt<span class="token punctuation">[</span><span class="token string">"date"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>month

df_pd_dt<span class="token punctuation">[</span><span class="token string">"product_upper"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_pd_dt<span class="token punctuation">[</span><span class="token string">"product"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">df_pl_dt <span class="token operator">=</span> <span class="token punctuation">(</span>df_pl5
            <span class="token punctuation">.</span>with_columns<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"date"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>Date<span class="token punctuation">,</span> fmt<span class="token operator">=</span><span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span>with_columns<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"date"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>month<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">"month"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                          pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"product"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>to_uppercase<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alias<span class="token punctuation">(</span><span class="token string">"product_upper"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<hr>
<h2 id="mini‑benchmark-indicatif-1000-lignes">15) Mini‑benchmark (indicatif, 1000 lignes)</h2>
<p><strong>Pandas</strong></p>
<pre class=" language-python"><code class="prism  language-python"><span class="token keyword">import</span> time

_t0 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> _ <span class="token operator">=</span> df_pd<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">"category"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"quantity"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t_pd_grp <span class="token operator">=</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>_t0<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1000</span>
_t0 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> _ <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_pd<span class="token punctuation">,</span> sup_pd<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">"product"</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t_pd_join <span class="token operator">=</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>_t0<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1000</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">"GroupBy sum Pandas: {t_pd_grp:.2f} ms | Join Pandas: {t_pd_join:.2f} ms"</span><span class="token punctuation">)</span>
</code></pre>
<p><strong>Polars</strong></p>
<pre class=" language-python"><code class="prism  language-python">_t0 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> _ <span class="token operator">=</span> df_pl<span class="token punctuation">.</span>group_by<span class="token punctuation">(</span><span class="token string">"category"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>col<span class="token punctuation">(</span><span class="token string">"quantity"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t_pl_grp <span class="token operator">=</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>_t0<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1000</span>
_t0 <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> _ <span class="token operator">=</span> df_pl<span class="token punctuation">.</span>join<span class="token punctuation">(</span>pl<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>sup_pd<span class="token punctuation">)</span><span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token string">"product"</span><span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">"left"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> t_pl_join <span class="token operator">=</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span>_t0<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">1000</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token string">"GroupBy sum Polars: {t_pl_grp:.2f} ms | Join Polars: {t_pl_join:.2f} ms"</span><span class="token punctuation">)</span>
</code></pre>
<blockquote>
<p>À cette échelle, les écarts sont limités ; Polars prend l’avantage sur des volumes plus importants grâce au <strong>multi‑thread</strong> et au <strong>lazy</strong> (predicate/projection pushdown). Réfs : <a href="https://docs.pola.rs/user-guide/concepts/lazy-api/">Lazy API</a>.</p>
</blockquote>
<hr>
<h2 id="références">16) Références</h2>
<ul>
<li>Polars — Lazy API : <a href="https://docs.pola.rs/user-guide/concepts/lazy-api/">https://docs.pola.rs/user-guide/concepts/lazy-api/</a></li>
<li>Polars — Coming from Pandas : <a href="https://docs.pola.rs/user-guide/migration/pandas/">https://docs.pola.rs/user-guide/migration/pandas/</a></li>
<li>Cheatsheet Pandas→Polars (Rho Signal) : <a href="https://www.rhosignal.com/posts/polars-pandas-cheatsheet/">https://www.rhosignal.com/posts/polars-pandas-cheatsheet/</a></li>
<li>Pandas DataFrame (docs) : <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html</a></li>
</ul>
<hr>
<h2 id="suivez-moi-sur-mes-réseaux">Suivez-moi sur mes réseaux</h2>
<p><a href="https://www.tiktok.com/@georf_tech"><img src="https://img.icons8.com/ios-filled/50/000000/tiktok.png" alt="TikTok"></a><br>
<a href="https://www.youtube.com/watch?v=0QQBLeKGfrA"><img src="https://img.icons8.com/ios-filled/50/000000/youtube-play.png" alt="YouTube"></a></p>
<p>Ou utilisez des emojis :<br>
▶ <a href="https://www.youtube.com/https://www.youtube.com/@DIAM-IA">YouTube</a> | 🎵 <a href="https://www.tiktok.com/@georf_tech">TikTok</a></p>
</div>
</body>

</html>
